{"version":3,"names":["STATES","HIDDEN","ANIMATING","SHOWN","EASING","Easing","bezier","SCREEN_INDENT","Tooltip","React","forwardRef","incomingProps","ref","props","useDefaultProps","animationDuration","bg","color","p","rounded","mx","minW","zIndex","fontSize","useNativeDriver","container","useRef","useStateCallback","visible","top","left","menuWidth","menuHeight","buttonWidth","buttonHeight","marginAnimation","Animated","Value","opacityAnimation","state","setState","windowHeight","WINDOW_HEIGHT","StatusBar","currentHeight","invert","shadowMenuContainerStyle","opacity","marginTop","text","style","children","rest","animationStarted","modalVisible","useTheme","theme","computedStyle","getStyle","onDismiss","show","current","measureInWindow","parallel","timing","toValue","duration","easing","start","hide","useImperativeHandle","StyleSheet","absoluteFill","styles","shadowMenuContainer","triangle","create","position","backgroundColor","borderRadius","width","menuContainer","overflow"],"sources":["tooltip.component.tsx"],"sourcesContent":["import * as React from 'react';\nimport { useRef, useImperativeHandle } from 'react';\nimport {\n  View,\n  Modal,\n  Easing,\n  Animated,\n  StatusBar,\n  StyleSheet,\n  TouchableWithoutFeedback,\n} from 'react-native';\n\nimport { getStyle } from './tooltip.style';\nimport { useTheme } from '../../theme';\nimport { Text } from '../text/text.component';\nimport { Triangle } from './triangle.component';\nimport { TooltipProps, TooltipRef } from './tooltip.type';\nimport { useStateCallback, WINDOW_HEIGHT } from '../../utilities';\nimport { useDefaultProps } from '../../utilities/useDefaultProps';\n\nconst STATES = {\n  HIDDEN: 'HIDDEN',\n  ANIMATING: 'ANIMATING',\n  SHOWN: 'SHOWN',\n};\n\nconst EASING = Easing.bezier(0.4, 0, 0.2, 1);\nconst SCREEN_INDENT = 8;\n\nconst Tooltip = React.forwardRef<\n  TooltipRef,\n  React.PropsWithChildren<TooltipProps>\n>((incomingProps, ref) => {\n  const props = useDefaultProps('Tooltip', incomingProps, {\n    animationDuration: 300,\n    bg: 'gray900',\n    color: 'white',\n    p: 'md',\n    rounded: 'xl',\n    mx: 'lg',\n    minW: 50,\n    zIndex: 1,\n    fontSize: 'md',\n    useNativeDriver: false,\n  });\n\n  const container = useRef<View>(null);\n  const [state, setState] = useStateCallback({\n    visible: STATES.HIDDEN,\n    top: 0,\n    left: 0,\n    menuWidth: 0,\n    menuHeight: 0,\n    buttonWidth: 0,\n    buttonHeight: 0,\n    marginAnimation: new Animated.Value(-8),\n    opacityAnimation: new Animated.Value(0),\n  });\n  const {\n    visible,\n    menuHeight,\n    buttonHeight,\n    opacityAnimation,\n    marginAnimation,\n  } = state;\n  let { top } = state;\n  const windowHeight = WINDOW_HEIGHT - (StatusBar.currentHeight ?? 0);\n  let invert = false;\n  if (top + menuHeight + buttonHeight + SCREEN_INDENT > windowHeight) {\n    top = top - menuHeight - SCREEN_INDENT;\n    invert = true;\n  } else if (top < SCREEN_INDENT) {\n    top = SCREEN_INDENT + buttonHeight;\n  } else {\n    top = top + buttonHeight + SCREEN_INDENT;\n    invert = false;\n  }\n  const shadowMenuContainerStyle = {\n    opacity: opacityAnimation,\n    top,\n    marginTop: marginAnimation,\n  };\n  const {\n    text,\n    style,\n    children,\n    bg,\n    animationDuration,\n    useNativeDriver,\n    ...rest\n  } = props;\n  const animationStarted = visible === STATES.ANIMATING;\n  const modalVisible = visible === STATES.SHOWN || animationStarted;\n  const { theme } = useTheme();\n  const computedStyle = getStyle(theme, props, {\n    ...state,\n    invert,\n  });\n\n  /**\n   * on dismissal of tooltip\n   *\n   * TODO: add onDismiss event\n   */\n  const onDismiss = () => {};\n\n  /**\n   * shows the tooltip\n   */\n  const show = () => {\n    if (container.current) {\n      container.current.measureInWindow(\n        (left: any, top: any, buttonWidth: any, buttonHeight: any) => {\n          setState(\n            {\n              ...state,\n              buttonHeight,\n              buttonWidth,\n              left,\n              visible: STATES.SHOWN,\n              top,\n            },\n            () => {\n              Animated.parallel([\n                Animated.timing(state.marginAnimation, {\n                  toValue: 0,\n                  duration: animationDuration,\n                  easing: EASING,\n                  useNativeDriver: useNativeDriver!,\n                }),\n                Animated.timing(state.opacityAnimation, {\n                  toValue: 1,\n                  duration: animationDuration,\n                  easing: EASING,\n                  useNativeDriver: useNativeDriver!,\n                }),\n              ]).start();\n            }\n          );\n        }\n      );\n    }\n  };\n\n  /**\n   * hides the tooltip\n   *\n   * @param onHidden\n   */\n  const hide = () => {\n    Animated.timing(state.opacityAnimation, {\n      toValue: 0,\n      duration: animationDuration,\n      easing: EASING,\n      useNativeDriver: useNativeDriver!,\n    }).start(() => {\n      setState({\n        ...state,\n        visible: STATES.HIDDEN,\n        marginAnimation: new Animated.Value(-8),\n        opacityAnimation: new Animated.Value(0),\n      });\n    });\n  };\n\n  /**\n   * exposing functions to parent\n   */\n  useImperativeHandle(ref, () => ({\n    show() {\n      show();\n    },\n    hide() {\n      hide();\n    },\n  }));\n\n  return (\n    <View ref={container} onLayout={() => null}>\n      <View>{children}</View>\n      <Modal\n        visible={modalVisible}\n        onRequestClose={hide}\n        supportedOrientations={[\n          'portrait',\n          'portrait-upside-down',\n          'landscape',\n          'landscape-left',\n          'landscape-right',\n        ]}\n        transparent\n        onDismiss={onDismiss}\n      >\n        <TouchableWithoutFeedback onPress={hide} accessible={false}>\n          <View style={StyleSheet.absoluteFill}>\n            <Animated.View\n              style={[\n                styles.shadowMenuContainer,\n                shadowMenuContainerStyle,\n                style,\n              ]}\n            >\n              <Triangle invert={invert} style={computedStyle.triangle} />\n              <Animated.View style={computedStyle.container}>\n                {typeof text === 'string' ? (\n                  <Text {...rest}>{text}</Text>\n                ) : (\n                  text\n                )}\n              </Animated.View>\n            </Animated.View>\n          </View>\n        </TouchableWithoutFeedback>\n      </Modal>\n    </View>\n  );\n});\n\n// Tooltip.defaultProps = {\n//   animationDuration: 300,\n//   bg: 'gray900',\n//   color: 'white',\n//   p: 'md',\n//   rounded: 'xl',\n//   mx: 'lg',\n//   minW: 50,\n//   zIndex: 1,\n//   fontSize: 'md',\n//   useNativeDriver: false,\n// };\n\nconst styles = StyleSheet.create({\n  shadowMenuContainer: {\n    position: 'absolute',\n    backgroundColor: 'transparent',\n    borderRadius: 4,\n    opacity: 0,\n    width: '100%',\n  },\n  menuContainer: {\n    overflow: 'hidden',\n  },\n});\n\nexport { Tooltip };\n"],"mappings":"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"}